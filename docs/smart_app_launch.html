<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<meta name="description" content="openEHR SMART App Launch and Service Discovery Framework (SMART)">
<meta name="keywords" content="JSON, REST, SMART, OAuth2, OIDC, Authentication, Authorization, Application, App">
<title>SMART on openEHR (SMART)</title>
<link rel="stylesheet" href="https://specifications.openehr.org/styles/openehr.css">
<link rel="stylesheet" href="https://specifications.openehr.org/styles/pygments-default.css">
<link rel="stylesheet" href="https://specifications.openehr.org/styles/asciidoctor-tabs.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#_smart_on_openehr_smart">SMART on openEHR (SMART)</a>
<ul class="sectlevel1">
<li><a href="#_amendment_record">Amendment Record</a></li>
<li><a href="#_acknowledgements">Acknowledgements</a>
<ul class="sectlevel2">
<li><a href="#_primary_author">Primary Author</a></li>
<li><a href="#_contributors">Contributors</a></li>
<li><a href="#_trademarks">Trademarks</a></li>
</ul>
</li>
<li><a href="#_preface">1. Preface</a>
<ul class="sectlevel2">
<li><a href="#_purpose">1.1. Purpose</a></li>
<li><a href="#_related_documents">1.2. Related Documents</a></li>
<li><a href="#_status">1.3. Status</a></li>
<li><a href="#_feedback">1.4. Feedback</a></li>
</ul>
</li>
<li><a href="#_overview">2. Overview</a>
<ul class="sectlevel2">
<li><a href="#_background">2.1. Background</a></li>
<li><a href="#_glossary">2.2. Glossary</a></li>
<li><a href="#_why_smart_on_openehr">2.3. Why SMART on openEHR?</a></li>
<li><a href="#_foundational_concepts">2.4. Foundational Concepts</a></li>
</ul>
</li>
<li><a href="#_application_registration">3. Application Registration</a></li>
<li><a href="#_service_discovery">4. Service Discovery</a>
<ul class="sectlevel2">
<li><a href="#_authentication_endpoints">4.1. Authentication Endpoints</a></li>
<li><a href="#_services">4.2. Services</a></li>
<li><a href="#_capabilities">4.3. Capabilities</a></li>
</ul>
</li>
<li><a href="#_application_types">5. Application Types</a>
<ul class="sectlevel2">
<li><a href="#_classified_by_credential_handling">5.1. Classified by Credential Handling</a></li>
<li><a href="#_classified_by_user_interaction">5.2. Classified by User Interaction</a></li>
</ul>
</li>
<li><a href="#_authentication">6. Authentication</a>
<ul class="sectlevel2">
<li><a href="#_supported_authentication_flows">6.1. Supported Authentication Flows</a></li>
<li><a href="#_client_authentication_methods">6.2. Client Authentication Methods</a></li>
<li><a href="#_deprecated_flows">6.3. Deprecated Flows</a></li>
<li><a href="#_flow_recommendations">6.4. Flow Recommendations</a></li>
</ul>
</li>
<li><a href="#_authorization">7. Authorization</a>
<ul class="sectlevel2">
<li><a href="#_smart_authorization_flow">7.1. SMART Authorization Flow</a></li>
<li><a href="#_context_selection">7.2. Context Selection</a></li>
<li><a href="#_embedded_iframe_launch">7.3. Embedded iFrame Launch</a></li>
</ul>
</li>
<li><a href="#_scopes">8. Scopes</a>
<ul class="sectlevel2">
<li><a href="#_resource_scopes">8.1. Resource Scopes</a></li>
</ul>
</li>
<li><a href="#_experimental_features">9. Experimental features</a>
<ul class="sectlevel2">
<li><a href="#_launch_parameter_as_a_token">9.1. Launch Parameter as a Token</a></li>
<li><a href="#_experimental_episode_context">9.2. Experimental: Episode Context</a>
<ul class="sectlevel3">
<li><a href="#_scopes_and_capabilities">9.2.1. Scopes and Capabilities</a></li>
<li><a href="#_token_response_parameters">9.2.2. Token Response Parameters</a></li>
<li><a href="#_launch_scenarios">9.2.3. Launch Scenarios</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_references">References</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock text-center">
<div class="content">
<img src="https://specifications.openehr.org/images/openEHR_logo_RGB.svg" alt="openEHR logo">
</div>
</div>
</div>
</div>
<h1 id="_smart_on_openehr_smart" class="sect0"><a class="anchor" href="#_smart_on_openehr_smart"></a>SMART on openEHR (SMART)</h1>
<div class="openblock partintro">
<div class="content">
<table class="tableblock frame-all grid-all fit-content spread">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2"><strong>Issuer</strong>: <a href="https://www.openehr.org/programs/specification" target="_blank" rel="noopener">openEHR Specification Program</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Release</strong>: ITS-REST development</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Status</strong>: DEVELOPMENT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Revision</strong>: <a href="#latest_issue">[latest_issue]</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Date</strong>: <a href="#latest_issue_date">[latest_issue_date]</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>Keywords</strong>: JSON, REST, SMART, OAuth2, OIDC, Authentication, Authorization, Application, App</p></td>
</tr>
</tbody>
</table>
<div class="imageblock text-center">
<div class="content">
<object type="image/svg+xml" data="openehr_block_diagram.svg" width="60%"><span class="alt">openEHR components</span></object>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2">&#169; 2023 - 2025 The openEHR Foundation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><a href="https://www.openehr.org" target="_blank" rel="noopener">The openEHR Foundation</a> is an independent, non-profit foundation, facilitating the sharing of health records by consumers and clinicians via open specifications, clinical models and open platform implementations.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Licence</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="https://specifications.openehr.org/images/cc-by-nd-88x31.png" alt="image"></span> Creative Commons Attribution-NoDerivs 3.0 Unported. <a href="https://creativecommons.org/licenses/by-nd/3.0/" class="bare">https://creativecommons.org/licenses/by-nd/3.0/</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Support</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Issues: <a href="https://specifications.openehr.org/components/ITS-REST/open_issues" target="_blank" rel="noopener">Problem Reports</a><br>
 Web: <a href="https://specifications.openehr.org" target="_blank" rel="noopener">specifications.openEHR.org</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_amendment_record"><a class="anchor" href="#_amendment_record"></a>Amendment Record</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 54.5454%;">
<col style="width: 18.1818%;">
<col style="width: 18.1819%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Issue</th>
<th class="tableblock halign-left valign-top">Details</th>
<th class="tableblock halign-left valign-top">Raiser</th>
<th class="tableblock halign-left valign-top">Completed</th>
</tr>
</thead>
<tbody>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>ITS_REST Release (unreleased)</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="latest_issue"></a>1.1.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reworded and structurally improved multiple sections of the specification for clarity, consistency, and technical accuracy; introduced a consolidated section for the experimental features.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S Iancu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="latest_issue_date"></a>20 May 2025</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECITS-69" target="_blank" rel="noopener">SPECITS-69</a>. Adding "SMART on openEHR" specifications.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S Ramesh,<br>
S Iancu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">09 Sep 2023</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_acknowledgements"><a class="anchor" href="#_acknowledgements"></a>Acknowledgements</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_primary_author"><a class="anchor" href="#_primary_author"></a>Primary Author</h3>
<div class="ulist">
<ul>
<li>
<p>Sidharth Ramesh; Medblocks.</p>
</li>
<li>
<p>Sebastian Iancu; Architect, Code24, Netherlands</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_contributors"><a class="anchor" href="#_contributors"></a>Contributors</h3>
<div class="paragraph">
<p>This specification has benefited from formal and informal input from the openEHR and wider health informatics community. The openEHR Foundation would like to recognise the following for their contributions.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ian McNicoll MD, FreshEHR, UK</p>
</li>
<li>
<p>Bostjan Lah, Senior Architect, Better, Slovenia</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A significant part of the design ideas of this specification was derived from:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SMART App Launch - Release 2.1.0, published by HL7® FHIR® standard</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_trademarks"><a class="anchor" href="#_trademarks"></a>Trademarks</h3>
<div class="ulist">
<ul>
<li>
<p>'openEHR' is a registered trademark of the openEHR Foundation</p>
</li>
<li>
<p>HL7® and FHIR® are the registered trademark of the Health Level Seven International and their use does not constitute endorsement by HL7</p>
</li>
<li>
<p>SMART™ and the SMART logos are trademarks of The Children’s Medical Center Corporation. Used with permission.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_preface"><a class="anchor" href="#_preface"></a>1. Preface</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_purpose"><a class="anchor" href="#_purpose"></a>1.1. Purpose</h3>
<div class="paragraph">
<p>This document describes the SMART framework for an openEHR enabled platform.</p>
</div>
<div class="paragraph">
<p>The intended audience includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>EHR systems, Platform or Application vendors;</p>
</li>
<li>
<p>Standards bodies producing health informatics standards;</p>
</li>
<li>
<p>Solution vendors.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_documents"><a class="anchor" href="#_related_documents"></a>1.2. Related Documents</h3>
<div class="paragraph">
<p>Prerequisite documents for reading this document include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="https://specifications.openehr.org/releases/BASE/latest/architecture_overview.html" target="_blank" rel="noopener">openEHR Architecture Overview</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/ITS-REST/development">openEHR REST APIs</a></p>
</li>
<li>
<p>HL7 FHIR <a href="https://hl7.org/fhir/smart-app-launch/STU2.1/" target="_blank" rel="noopener">SMART App Launch Implementation Guide</a></p>
</li>
<li>
<p>'About SMART' page on <a href="https://smarthealthit.org/about-smart-2/" target="_blank" rel="noopener">SMART Health IT</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc6749" target="_blank" rel="noopener">OAuth 2.0 Authorization Framework</a></p>
</li>
<li>
<p><a href="https://openid.net/specs/openid-connect-core-1_0.html#Authentication" target="_blank" rel="noopener">OpenId Connect (OIDC)</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_status"><a class="anchor" href="#_status"></a>1.3. Status</h3>
<div class="paragraph">
<p>This specification is in the DEVELOPMENT state. The development version of this document can be found at <a href="https://specifications.openehr.org/releases/ITS-REST/development/smart_app_launch.html" target="_blank" rel="noopener">https://specifications.openehr.org/releases/ITS-REST/development/smart_app_launch.html</a>.</p>
</div>
<div class="paragraph">
<p>Known omissions or questions are indicated in the text with a 'to be determined' paragraph, as follows:</p>
</div>
<div class="paragraph tbd">
<p><strong>TBD</strong>: (example To Be Determined paragraph)</p>
</div>
</div>
<div class="sect2">
<h3 id="_feedback"><a class="anchor" href="#_feedback"></a>1.4. Feedback</h3>
<div class="paragraph">
<p>Feedback may be provided on the <a href="https://discourse.openehr.org/c/specifications/its" target="_blank" rel="noopener">openEHR ITS forum</a>.</p>
</div>
<div class="paragraph">
<p>Issues may be raised on the <a href="https://specifications.openehr.org/components/ITS-REST/open_issues" target="_blank" rel="noopener">specifications Problem Report tracker</a>.</p>
</div>
<div class="paragraph">
<p>To see changes made due to previously reported issues, see the <a href="https://specifications.openehr.org/components/ITS-REST/history" target="_blank" rel="noopener">ITS-REST component Change Request tracker</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overview"><a class="anchor" href="#_overview"></a>2. Overview</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_background"><a class="anchor" href="#_background"></a>2.1. Background</h3>
<div class="paragraph">
<p><strong>SMART</strong> stands for “Substitutable Medical Applications and Reusable Technologies”, a healthcare standard enabling applications to access clinical information from a data store.
It was originally proposed by the <a href="https://smarthealthit.org/" target="_blank" rel="noopener">SMART Health IT</a> project (run by the Computational Health Informatics Program at Boston Children’s Hospital) and later formalized as <a href="https://hl7.org/fhir/smart-app-launch/STU2.1/" target="_blank" rel="noopener">SMART App Launch Framework</a>, layered on top of the <a href="https://www.hl7.org/fhir" target="_blank" rel="noopener">FHIR APIs</a> to facilitate standardized data access.</p>
</div>
<div class="paragraph">
<p>The specification builds on <a href="https://tools.ietf.org/html/rfc6749" target="_blank" rel="noopener">OAuth 2.0</a> and <a href="https://openid.net/specs/openid-connect-core-1_0.html#Authentication" target="_blank" rel="noopener">OpenID Connect (OIDC)</a>, widely adopted industry standards for authentication and authorization.
It allows third-party applications to authenticate and interoperate securely with any compliant system.
It also defines launch sequences, token scopes, context passing mechanisms, and FHIR-based data access norms.</p>
</div>
</div>
<div class="sect2">
<h3 id="_glossary"><a class="anchor" href="#_glossary"></a>2.2. Glossary</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 12.5%;">
<col style="width: 87.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Term</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SMART on openEHR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This specification document detailing the SMART framework for an openEHR enabled platform</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SMART App Launch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The original SMART framework specified by HL7 FHIR, often referred as "SMART on FHIR"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vendor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An entity that develops and supplies software to end-users.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The individual operating the Application to perform specific functions; also referred to as the "end-user".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A software application developed by a Vendor to operate with a Platform and/or Launcher, potentially built by the same or a different Vendor. In OAuth terminology this is the "client", whereas in FHIR is often called the "SMART App".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Platform</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A software ecosystem comprising at minimum an Authorization Server, an openEHR Clinical Data Repository (CDR), and a FHIR Server. It exposes openEHR REST APIs, FHIR APIs, and possibly other APIs. In FHIR this is often referred to as the "EHR system". The Platform includes the authentication and authorization infrastructure that supports OAuth 2.0 Framework and this specification.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Launcher</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A user-facing application, typically developed by the Platform vendor, which initiates the launch of Applications within the context of a specific Patient or Practitioner. The Launcher may be integrated into the Platform&#8217;s main application (e.g. as a Portal) or exist as an independent application.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EHR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A (session) context representing the <a href="https://specifications.openehr.org/releases/RM/latest/ehr.html#_ehr_package" target="_blank" rel="noopener">openEHR <code>EHR</code> container</a> for the corresponding Patient, indicating the subject of interactions through the Application.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The <a href="https://hl7.org/fhir/smart-app-launch/STU2.1/" target="_blank" rel="noopener">SMART App Launch Framework</a> specification uses the terms '<em>EHR</em>' and '<em>EHR system</em>' to describe a system comprising a FHIR Server, Authorization Server, and potentially other components, including a Launcher.</p>
</div>
<div class="paragraph">
<p>In contrast, openEHR defines an <a href="https://specifications.openehr.org/releases/RM/latest/ehr.html" target="_blank" rel="noopener">EHR Information Model</a>, centered around the <a href="https://specifications.openehr.org/releases/RM/latest/ehr.html#_root_ehr_object" target="_blank" rel="noopener">root <code>EHR</code> container</a>.</p>
</div>
<div class="paragraph">
<p>To avoid ambiguity, this specification reserves the term '<em>EHR</em>' exclusively for references to openEHR constructs (e.g., EHR type, EHR ID).
Alternate terminology will be used to describe equivalent FHIR-based system components.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_why_smart_on_openehr"><a class="anchor" href="#_why_smart_on_openehr"></a>2.3. Why SMART on openEHR?</h3>
<div class="paragraph">
<p>A widely accepted vision today is that no single software vendor can provide all the necessary tools and solutions required by a modern healthcare system, while simultaneously ensuring high quality and maintaining a low total cost of ownership.
Independent vendors, specializing in solving specific problems, often offer advantages over monolithic software suites attempting to address all needs.</p>
</div>
<div class="paragraph">
<p>In practice, this vision necessitates a collaborative ecosystem where applications from multiple vendors operate together to deliver a comprehensive solution.
This approach is often referred to as a "best-of-breed" architecture.
However, current implementations typically involve a lengthy and complex manual "integration" phase, during which vendors must coordinate their systems to interoperate, an expensive and time-consuming process that poses a significant barrier to entry for new vendors.</p>
</div>
<div class="paragraph">
<p>The SMART specification addresses this challenge by standardizing the security and interactions between systems and applications.
It establishes a clear contract between the <em>Application Vendor</em> and the <em>Platform Vendor</em>, covering the following requirements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <em>Application</em> must be able to run on a domain owned by the <em>Application Vendor</em>.</p>
</li>
<li>
<p>The <em>Platform</em> must be able to operate on a domain owned by the <em>Platform Vendor</em>.</p>
</li>
<li>
<p>The <em>Application</em> must be able to discover the API services provided by the <em>Platform</em>.</p>
</li>
<li>
<p>The <em>Application</em> must be able to authenticate with the <em>Platform</em> to access its APIs.</p>
</li>
<li>
<p>The <em>Platform</em> must be able to authorize the <em>Application</em> for specific actions and data access, based on user roles and granted scopes.</p>
</li>
<li>
<p>The <em>Application</em> must be able to determine the active operational "context" managed by the <em>Platform</em>, such as the current EHR.</p>
</li>
<li>
<p>The <em>Application</em> must be able to embed within the <em>Platform</em>'s user interface while maintaining the current context to ensure a seamless user experience.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <strong>SMART on openEHR</strong> specification is designed to maintain compatibility with <a href="https://hl7.org/fhir/smart-app-launch/STU2.1/" target="_blank" rel="noopener">SMART App Launch Framework</a>, while extending it to work with <a href="https://specifications.openehr.org/releases/ITS-REST/development" target="_blank" rel="noopener">openEHR REST APIs</a> and potentially other API types.
It defines a framework supporting the following capabilities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#_application_registration">Application Registration</a></p>
</li>
<li>
<p><a href="#_service_discovery">Service Discovery</a></p>
</li>
<li>
<p><a href="#_authentication">Authentication</a></p>
</li>
<li>
<p><a href="#_authorization">Authorization</a></p>
</li>
<li>
<p><a href="#_scopes">Scopes</a></p>
</li>
<li>
<p><a href="#_context_selection">Context Selection</a></p>
</li>
<li>
<p><a href="#_embedded_iframe_launch">Embedded iFrame Launch</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_foundational_concepts"><a class="anchor" href="#_foundational_concepts"></a>2.4. Foundational Concepts</h3>
<div class="paragraph">
<p>The <a href="https://specifications.openehr.org/releases/RM/latest/index" target="_blank" rel="noopener">openEHR Reference Model</a> and the <a href="https://specifications.openehr.org/releases/ITS-REST/development/ehr.html" target="_blank" rel="noopener">openEHR REST API specification</a> provide the foundational structure for interoperable <em>Applications</em>.
For these applications to be truly portable across systems and vendors, a standardized approach to <em>authentication</em> and <em>authorization</em> is essential.</p>
</div>
<div class="paragraph">
<p><em>Authentication</em> is the process of verifying the identity of an end-user or client application, while <em>Authorization</em> is the process of determining what access or privileges that entity has.</p>
</div>
<div class="paragraph">
<p>The <strong>SMART on openEHR</strong> specification builds on the <a href="https://tools.ietf.org/html/rfc6749" target="_blank" rel="noopener">OAuth 2.0 Framework</a> and optionally <a href="https://openid.net/specs/openid-connect-core-1_0.html#Authentication" target="_blank" rel="noopener">OpenID Connect (OIDC)</a>, to allow third-party applications to securely obtain authorized access to protected healthcare data exposed as APIs by the <em>Platform</em>.</p>
</div>
<div class="paragraph">
<p>Moreover, many such applications operate within the <em>context</em> of a specific Patient or a particular Episode.
Therefore, selection of the appropriate <em>context</em> becomes a critical prerequisite for launching the <em>Application</em>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_application_registration"><a class="anchor" href="#_application_registration"></a>3. Application Registration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before an <em>Application</em> can integrate with a <em>Platform</em>, it must first be registered.
This registration process establishes a trusted relationship between the <em>Application Vendor</em> and the <em>Platform Vendor</em>, and includes the configuration of necessary parameters for authentication, authorization, and launch.</p>
</div>
<div class="paragraph">
<p>The registration process includes the following steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <em>Application</em> registers with the <em>Platform</em> by submitting metadata such as:</p>
<div class="ulist">
<ul>
<li>
<p>Application name, logo and identifier</p>
</li>
<li>
<p>Authorized domains and redirection URIs (<code>redirect_uri</code>)</p>
</li>
<li>
<p>Supported launch contexts (e.g., patient, practitioner)</p>
</li>
<li>
<p>Application type (e.g., confidential or public client)</p>
</li>
<li>
<p>Client JSON Web Keys (JWKs) or a JWK Set URL</p>
</li>
<li>
<p>Requested OAuth 2.0 scopes</p>
</li>
</ul>
</div>
</li>
<li>
<p>Upon successful registration, the <em>Platform</em> issues credentials to the <em>Application</em>, such as:</p>
<div class="ulist">
<ul>
<li>
<p>A unique <code>client_id</code> (always required)</p>
</li>
<li>
<p>A <code>client_secret</code> (for confidential clients)</p>
</li>
<li>
<p>Optionally, a set of JSON Web Keys (JWKs) or a JWK Set URL (<code>jwks_uri</code>) for JWT-based client authentication</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>These credentials are used in subsequent OAuth 2.0 flows to authenticate the <em>Application</em> and enable secure, scoped access to protected resources.</p>
</div>
<div class="paragraph">
<p>The <a href="https://hl7.org/fhir/smart-app-launch/STU2.1/client-confidential-asymmetric.html#registering-a-client-communicating-public-keys" target="_blank" rel="noopener">SMART App Launch Framework</a> describes a corresponding registration flow, including support for registering public keys using <code>jwks</code> or <code>jwks_uri</code> to enable secure client authentication. The <strong>SMART on openEHR</strong> specification adopts a compatible approach, extending these mechanisms for use with openEHR-based APIs and platforms.</p>
</div>
<div class="paragraph">
<p>While this registration process could be formalized and automated using the <a href="https://tools.ietf.org/html/rfc7591" target="_blank" rel="noopener">OAuth 2.0 Dynamic Client Registration Protocol</a>, the current recommendation is to handle registration out-of-band in a way that is practical for both the Application Vendor and the Platform Vendor.
For example, the <em>Platform</em> may provide a dedicated registration portal where <em>Application Vendors</em> can submit their applications for review. This portal may support approval workflows, audit trails, and administrative oversight before issuing credentials, ensuring that only vetted applications are authorized to interact with the Platform.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_service_discovery"><a class="anchor" href="#_service_discovery"></a>4. Service Discovery</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A <em>Platform</em> typically exposes multiple service endpoints.
These include OAuth 2.0 endpoints such as Authorization and Token, standard data service endpoints (e.g., openEHR REST APIs, FHIR APIs), and possibly other standard or proprietary APIs (e.g. DICOMWeb APIs).</p>
</div>
<div class="paragraph">
<p>The <strong>SMART Service Discovery</strong> mechanism extends the <a href="https://hl7.org/fhir/smart-app-launch/STU2.1/conformance.html#using-well-known" target="_blank" rel="noopener">FHIR <code>.well-known/smart-configuration</code></a> endpoint definition.
It allows a <em>Platform</em> to advertise <a href="#_authentication_endpoints">authentications</a> endpoint, SMART <a href="#_capabilities">capabilities</a>, and a list of available <a href="#_services">services</a>.</p>
</div>
<div id="smart_service_discovery" class="imageblock text-center text-center">
<div class="content">
<img src="smart_app_launch/diagrams/smart_service_discovery.svg" alt="smart service discovery">
</div>
<div class="title">Figure 1. SMART Service Discovery</div>
</div>
<div class="paragraph">
<p>The configuration endpoint should be always available relative to the <em>Platform</em> base URL.
For example, given a base URL as <code>https://platform.example.com</code>, the SMART configuration endpoint must be available at <code>https://platform.example.com/.well-known/smart-configuration</code>.
If the base URL includes a path segment as <code>https://platform.example.com/gateway/v1</code>, then the configuration should be accessible at <code>https://platform.example.com/gateway/v1/.well-known/smart-configuration</code>.</p>
</div>
<div class="paragraph">
<p>Unlike the <a href="https://hl7.org/fhir/smart-app-launch/STU2.1/conformance.html#using-well-known" target="_blank" rel="noopener">FHIR <code>.well-known/smart-configuration</code></a>, which defines the configuration endpoint relative to the base URL of the FHIR server, this specification defines this endpoint relative to the <em>Platform</em> base URL (i.e. the gateway).
This allows the <em>Platform</em> to advertise service capabilities beyond FHIR APIs, including openEHR REST APIs and other APIs that may not be part of the FHIR server itself.
While this provides greater flexibility and aligns with a multi-API architecture, <em>Platform</em> vendors are encouraged to ensure compatibility with SMART FHIR applications by maintaining a consistent <code>issuer</code> and exposing the FHIR API at the same base URL when feasible.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>In order to maintain compatibility with SMART App Launch, it is recommended that the base URL of the <em>Platform</em> also acts as the base URL of the FHIR server.
Such applications often assume the <code>iss</code> (issuer) launch parameter is both the base FHIR endpoint and the <code>issuer</code> value in the configuration document.
<em>Platform</em> vendors may implement this alignment using gateways, proxies, or redirection mechanisms. However, such implementation details are outside the scope of this specification.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Responses to <code>/.well-known/smart-configuration</code> endpoint must be served with the <code>application/json</code> MIME type. A representative example is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span></span><span class="tok-p">{</span>
<span class="tok-w">  </span><span class="tok-nt">&quot;issuer&quot;</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s2">&quot;https://platform.example.com&quot;</span><span class="tok-p">,</span>
<span class="tok-w">  </span><span class="tok-nt">&quot;jwks_uri&quot;</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s2">&quot;https://platform.example.com/.well-known/jwks.json&quot;</span><span class="tok-p">,</span>
<span class="tok-w">  </span><span class="tok-nt">&quot;authorization_endpoint&quot;</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s2">&quot;https://platform.example.com/auth/authorize&quot;</span><span class="tok-p">,</span>
<span class="tok-w">  </span><span class="tok-nt">&quot;token_endpoint&quot;</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s2">&quot;https://platform.example.com/auth/token&quot;</span><span class="tok-p">,</span>
<span class="tok-w">  </span><span class="tok-nt">&quot;services&quot;</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">    </span><span class="tok-nt">&quot;org.openehr.rest&quot;</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">      </span><span class="tok-nt">&quot;baseUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;https://platform.example.com/openehr/rest/v1&quot;</span><span class="tok-p">,</span>
<span class="tok-w">      </span><span class="tok-nt">&quot;description&quot;</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s2">&quot;The openEHR REST APIs baseUrl&quot;</span><span class="tok-p">,</span>
<span class="tok-w">      </span><span class="tok-nt">&quot;documentation&quot;</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s2">&quot;https://example.com/openehr/docs&quot;</span><span class="tok-p">,</span>
<span class="tok-w">      </span><span class="tok-nt">&quot;openapi&quot;</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s2">&quot;https://example.com/openehr/rest/v1/openapi.json&quot;</span>
<span class="tok-w">    </span><span class="tok-p">},</span>
<span class="tok-w">    </span><span class="tok-nt">&quot;org.fhir.rest&quot;</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">      </span><span class="tok-nt">&quot;baseUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;https://platform.example.com/&quot;</span><span class="tok-p">,</span>
<span class="tok-w">      </span><span class="tok-nt">&quot;description&quot;</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s2">&quot;The FHIR APIs baseUrl&quot;</span>
<span class="tok-w">    </span><span class="tok-p">},</span>
<span class="tok-w">    </span><span class="tok-nt">&quot;com.amazon.aws.s3.rest&quot;</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">      </span><span class="tok-nt">&quot;baseUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;https://s3.example.com/storage&quot;</span><span class="tok-p">,</span>
<span class="tok-w">      </span><span class="tok-nt">&quot;documentation&quot;</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s2">&quot;https://example.com/s3/docs&quot;</span><span class="tok-p">,</span>
<span class="tok-w">      </span><span class="tok-nt">&quot;openapi&quot;</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s2">&quot;https://example.com/s3/openapi.json&quot;</span>
<span class="tok-w">    </span><span class="tok-p">},</span>
<span class="tok-w">    </span><span class="tok-nt">&quot;com.example.demographics&quot;</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">      </span><span class="tok-nt">&quot;baseUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;https://demographics.example.com/rest&quot;</span>
<span class="tok-w">    </span><span class="tok-p">}</span>
<span class="tok-w">  </span><span class="tok-p">},</span>
<span class="tok-w">  </span><span class="tok-nt">&quot;token_endpoint_auth_methods_supported&quot;</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span>
<span class="tok-w">    </span><span class="tok-s2">&quot;client_secret_basic&quot;</span><span class="tok-p">,</span>
<span class="tok-w">    </span><span class="tok-s2">&quot;private_key_jwt&quot;</span>
<span class="tok-w">  </span><span class="tok-p">],</span>
<span class="tok-w">  </span><span class="tok-nt">&quot;grant_types_supported&quot;</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span>
<span class="tok-w">    </span><span class="tok-s2">&quot;authorization_code&quot;</span><span class="tok-p">,</span>
<span class="tok-w">    </span><span class="tok-s2">&quot;client_credentials&quot;</span>
<span class="tok-w">  </span><span class="tok-p">],</span>
<span class="tok-w">  </span><span class="tok-nt">&quot;registration_endpoint&quot;</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s2">&quot;https://platform.example.com/auth/register&quot;</span><span class="tok-p">,</span>
<span class="tok-w">  </span><span class="tok-nt">&quot;scopes_supported&quot;</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-s2">&quot;openid&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s2">&quot;profile&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s2">&quot;launch&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s2">&quot;launch/patient&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s2">&quot;patient/*.rs&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s2">&quot;user/*.rs&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s2">&quot;offline_access&quot;</span><span class="tok-p">],</span>
<span class="tok-w">  </span><span class="tok-nt">&quot;response_types_supported&quot;</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-s2">&quot;code&quot;</span><span class="tok-p">],</span>
<span class="tok-w">  </span><span class="tok-nt">&quot;management_endpoint&quot;</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s2">&quot;https://platform.example.com/user/manage&quot;</span><span class="tok-p">,</span>
<span class="tok-w">  </span><span class="tok-nt">&quot;introspection_endpoint&quot;</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s2">&quot;https://platform.example.com/user/introspect&quot;</span><span class="tok-p">,</span>
<span class="tok-w">  </span><span class="tok-nt">&quot;revocation_endpoint&quot;</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s2">&quot;https://platform.example.com/user/revoke&quot;</span><span class="tok-p">,</span>
<span class="tok-w">  </span><span class="tok-nt">&quot;code_challenge_methods_supported&quot;</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-s2">&quot;S256&quot;</span><span class="tok-p">],</span>
<span class="tok-w">  </span><span class="tok-nt">&quot;capabilities&quot;</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span>
<span class="tok-w">    </span><span class="tok-s2">&quot;launch-ehr&quot;</span><span class="tok-p">,</span>
<span class="tok-w">    </span><span class="tok-s2">&quot;permission-patient&quot;</span><span class="tok-p">,</span>
<span class="tok-w">    </span><span class="tok-s2">&quot;permission-v2&quot;</span><span class="tok-p">,</span>
<span class="tok-w">    </span><span class="tok-s2">&quot;client-public&quot;</span><span class="tok-p">,</span>
<span class="tok-w">    </span><span class="tok-s2">&quot;client-confidential-symmetric&quot;</span><span class="tok-p">,</span>
<span class="tok-w">    </span><span class="tok-s2">&quot;context-ehr-patient&quot;</span><span class="tok-p">,</span>
<span class="tok-w">    </span><span class="tok-s2">&quot;sso-openid-connect&quot;</span><span class="tok-p">,</span>
<span class="tok-w">    </span><span class="tok-s2">&quot;context-openehr-ehr&quot;</span><span class="tok-p">,</span>
<span class="tok-w">    </span><span class="tok-s2">&quot;openehr-permission-v1&quot;</span><span class="tok-p">,</span>
<span class="tok-w">	</span><span class="tok-s2">&quot;launch-base64-json&quot;</span>
<span class="tok-w">  </span><span class="tok-p">]</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The details of the <code>/.well-known/smart-configuration</code> are described in the sections below.</p>
</div>
<div class="sect2">
<h3 id="_authentication_endpoints"><a class="anchor" href="#_authentication_endpoints"></a>4.1. Authentication Endpoints</h3>
<div class="paragraph">
<p>The following attributes in the <code>.well-known/openid-configuration</code> must match those defined in the OAuth 2.0 + <a href="https://openid.net/specs/openid-connect-discovery-1_0.html#ProviderConfig" target="_blank" rel="noopener">OpenID Connect Discovery</a> specification as well as the <a href="https://www.hl7.org/fhir/smart-app-launch/conformance.html#metadata" target="_blank" rel="noopener">FHIR SMART metadata</a> specification:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>issuer</code></p>
</li>
<li>
<p><code>jwks_uri</code></p>
</li>
<li>
<p><code>authorization_endpoint</code></p>
</li>
<li>
<p><code>grant_types_supported</code></p>
</li>
<li>
<p><code>token_endpoint</code></p>
</li>
<li>
<p><code>token_endpoint_auth_methods_supported</code></p>
</li>
<li>
<p><code>registration_endpoint</code></p>
</li>
<li>
<p><code>scopes_supported</code></p>
</li>
<li>
<p><code>management_endpoint</code></p>
</li>
<li>
<p><code>response_types_supported</code></p>
</li>
<li>
<p><code>introspection_endpoint</code></p>
</li>
<li>
<p><code>revocation_endpoint</code></p>
</li>
<li>
<p><code>capabilities</code></p>
</li>
<li>
<p><code>code_challenge_methods_supported</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_services"><a class="anchor" href="#_services"></a>4.2. Services</h3>
<div class="paragraph">
<p>In addition to the <a href="https://www.hl7.org/fhir/smart-app-launch/conformance.html#metadata" target="_blank" rel="noopener">FHIR-specific metadata</a>, the response from configuration endpoint must include the <code>services</code> section describing the available service interfaces exposed by the <em>Platform</em>.
This section enables Applications to dynamically discover the APIs provided by the <em>Platform</em>, along with their respective base URLs, descriptions, and potentially documentation links.</p>
</div>
<div class="paragraph">
<p>The <code>services</code> is a hash map, where each key is a reverse domain name uniquely identifying a service (e.g., <code>org.openehr.rest</code>), and the corresponding value contains the service-specific metadata and base URL. This structure allows for a flexible and extensible way to declare multiple APIs that may coexist within the <em>Platform</em>.</p>
</div>
<div class="paragraph">
<p>At a minimum, the <code>services</code> section must include the openEHR REST API using the key <code>org.openehr.rest</code>.
For consistency reason, it is also recommended to include the FHIR API under the key <code>org.fhir.rest</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>org.openehr.rest</code>: The base URL of the openEHR REST APIs <code><strong>(required)</strong></code></p>
</li>
<li>
<p><code>org.fhir.rest</code>: The base URL of the FHIR APIs <code><strong>(recommended)</strong></code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Additional services, such as CDS Hooks endpoints, terminology services, or non-RESTful interfaces, may be included using appropriately namespaced keys. For example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>org.dicomstandard.dicomweb.rest</code>: DICOMWeb REST API endpoint</p>
</li>
<li>
<p><code>com.amazon.aws.s3.rest</code>: AWS S3-compatible REST API</p>
</li>
<li>
<p><code>com.example.demographics</code>: A vendor-specific demographic service</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each service definition may contain:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>baseUrl</code>: Absolute URL to the root of the API <code><strong>(required)</strong></code></p>
</li>
<li>
<p><code>description</code>: Human-readable description of the service</p>
</li>
<li>
<p><code>version</code>: Service API version</p>
</li>
<li>
<p><code>documentation</code>: Link to service documentation</p>
</li>
<li>
<p><code>openapi</code>: Link to the OpenAPI (Swagger) definition of the API</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span></span><span class="tok-p">{</span>
<span class="tok-w">    </span><span class="tok-nt">&quot;org.openehr.rest&quot;</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nt">&quot;baseUrl&quot;</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s2">&quot;https://platform.example.com/openehr/rest/v1&quot;</span><span class="tok-p">,</span>
<span class="tok-w">        </span><span class="tok-nt">&quot;description&quot;</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s2">&quot;The openEHR REST API baseUrl&quot;</span><span class="tok-p">,</span>
<span class="tok-w">        </span><span class="tok-nt">&quot;documentation&quot;</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s2">&quot;https://platform.example.com/openehr/docs&quot;</span><span class="tok-p">,</span>
<span class="tok-w">        </span><span class="tok-nt">&quot;openapi&quot;</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s2">&quot;https://platform.example.com/openehr/rest/v1/openapi.json&quot;</span>
<span class="tok-w">    </span><span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_capabilities"><a class="anchor" href="#_capabilities"></a>4.3. Capabilities</h3>
<div class="paragraph">
<p>The <code>capabilities</code> section advertises supported SMART features as an array value. In addition to those scopes defined in the original <a href="https://hl7.org/fhir/smart-app-launch/STU2.1/conformance.html#capabilities" target="_blank" rel="noopener">SMART App Launch</a> framework, the following capabilities extend the list for openEHR platforms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>context-openehr-ehr</code>: Indicates support for EHR-level launch context, requested via <code>launch/patient</code> scope and conveyed via the <code>ehrId</code> token claim.</p>
</li>
<li>
<p><code>context-openehr-episode</code>: Indicates support for Episode-level context, requested via <code>launch/episode</code>, scope conveyed via <code>episodeId</code> (<a href="#_experimental_episode_context">experimental</a>).</p>
</li>
<li>
<p><code>openehr-permission-v1</code>: Indicates support for fine-grained <a href="#_resource_scopes">scopes</a> and authorization scheme over openEHR resources.</p>
</li>
<li>
<p><code>launch-base64-json</code>: Indicates support for encoding launch context as a base64-encoded JSON object in the <code>launch</code> parameter.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_application_types"><a class="anchor" href="#_application_types"></a>5. Application Types</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The appropriate authentication flow depends on the type of the client <em>Application</em>, particularly its ability to securely manage credentials and the nature of its interaction with users or backend services. The <strong>SMART on openEHR</strong> specification defines two fundamental client types based on credential handling capabilities, and further distinguishes applications by their interaction model.</p>
</div>
<div class="sect2">
<h3 id="_classified_by_credential_handling"><a class="anchor" href="#_classified_by_credential_handling"></a>5.1. Classified by Credential Handling</h3>
<div class="paragraph">
<p>The following client application types are defined by the <a href="https://hl7.org/fhir/smart-app-launch/STU2.1/app-launch.html#support-for-public-and-confidential-apps" target="_blank" rel="noopener">considered by SMART specification</a> based on their ability to securely manage secrets or to secure the client authentication using other means:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Confidential applications</strong>:
These applications can securely hold credentials such as a <code>client_secret</code> or private keys. This category includes backend services, server-side web applications, and applications using hardware security modules or additional technology for higher security.</p>
</li>
<li>
<p><strong>Public applications</strong>:
These applications cannot securely store secrets. This includes native mobile apps and single-page web applications (SPAs) running in browsers. For these apps, authentication must rely on flows that do not require client credentials (e.g., PKCE).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The distinction between <em>public</em> and <em>confidential</em> clients is essential in determining the appropriate OAuth2 flow, and impacts which tokens can be safely issued and under what conditions.</p>
</div>
</div>
<div class="sect2">
<h3 id="_classified_by_user_interaction"><a class="anchor" href="#_classified_by_user_interaction"></a>5.2. Classified by User Interaction</h3>
<div class="paragraph">
<p>Applications are also classified by the context in which they are launched and the nature of their end-users:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Patient-facing applications</strong>:
These applications are used directly by the patient, or are launched by a practitioner in the context of a specific patient. Optionally, the launch may be tied to a particular episode of care.</p>
</li>
<li>
<p><strong>Practitioner-facing applications</strong>:
These applications are used by healthcare professionals and may operate within or outside the context of a specific patient or episode.</p>
</li>
<li>
<p><strong>Backend services</strong>:
These applications operate autonomously without direct user interaction. They are typically used for system-to-system communication or background processing, such as synchronization, analytics, or alerts.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_authentication"><a class="anchor" href="#_authentication"></a>6. Authentication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In line with the SMART framework, authentication is typically an integral part of the OAuth 2.0 authorization process.
For verifying end-user identity, an external identity provider is expected, typically using <a href="https://openid.net/specs/openid-connect-core-1_0.html#Authentication" target="_blank" rel="noopener">OpenID Connect (OIDC)</a>.
While OIDC is the recommended approach, the exact mechanisms of identity verification are considered implementation-specific and fall outside the scope of this specification.</p>
</div>
<div class="sect2">
<h3 id="_supported_authentication_flows"><a class="anchor" href="#_supported_authentication_flows"></a>6.1. Supported Authentication Flows</h3>
<div class="paragraph">
<p>Client <em>Applications</em> may authenticate with the <em>Platform</em> using one of the following OAuth2-compatible flows.
The choice of flow depends on the <a href="#_application_types">client application type</a> (public vs. confidential) and the desired security posture.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://tools.ietf.org/html/rfc6749#section-1.3.1" target="_blank" rel="noopener">Authorization Code Grant</a> with <a href="https://tools.ietf.org/html/rfc7636" target="_blank" rel="noopener">Proof Key for Code Exchange (PKCE)</a>:
Recommended for public clients (e.g., browser or mobile apps) as it does not require a client secret and mitigates interception risks.</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc6749#section-1.3.1" target="_blank" rel="noopener">Authorization Code Grant</a> with <code>client_secret</code>:
Suitable for confidential clients, such as backend web applications capable of securely storing secrets.</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc6749#section-1.3.4" target="_blank" rel="noopener">Client Credentials Grant</a>:
Used when no end-user is involved (e.g., background system-to-system communication).</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc7523" target="_blank" rel="noopener">JWT Bearer Token Grant</a>:
Preferred for confidential clients using asymmetric keys (e.g., JSON Web Keys) to authenticate via signed JWTs in accordance with <a href="https://tools.ietf.org/html/rfc7515" target="_blank" rel="noopener">JSON Web Signature (JWS)</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Platform</em> implementation must clearly advertise which flows are supported in its <code>.well-known/smart-configuration</code> metadata document. This allows clients to dynamically determine how to authenticate and obtain tokens.</p>
</div>
</div>
<div class="sect2">
<h3 id="_client_authentication_methods"><a class="anchor" href="#_client_authentication_methods"></a>6.2. Client Authentication Methods</h3>
<div class="paragraph">
<p>SMART distinguishes two main authentication methods for confidential clients:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://hl7.org/fhir/smart-app-launch/STU2.1/client-confidential-asymmetric.html" target="_blank" rel="noopener">Asymmetric Authentication</a>:
The preferred method in SMART framework. This approach avoids transmitting shared secrets. It leverages either the <a href="https://tools.ietf.org/html/rfc6749#section-1.3.4" target="_blank" rel="noopener">Client Credentials Grant</a> or the <a href="https://tools.ietf.org/html/rfc7523" target="_blank" rel="noopener">JWT Bearer Token Grant</a>, using public/private key pairs (e.g., JSON Web Keys) for authentication.</p>
</li>
<li>
<p><a href="https://hl7.org/fhir/smart-app-launch/STU2.1/client-confidential-symmetric.html" target="_blank" rel="noopener">Symmetric Authentication</a>:
This approach is simpler but less secure and uses a pre-shared <code>client_secret</code> to authenticate. Typically used with the <a href="https://tools.ietf.org/html/rfc6749#section-1.3.1" target="_blank" rel="noopener">Authorization Code Grant</a> flow.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_deprecated_flows"><a class="anchor" href="#_deprecated_flows"></a>6.3. Deprecated Flows</h3>
<div class="paragraph">
<p>The following OAuth 2.0 flows are discouraged and MUST NOT be used within SMART on openEHR due to security concerns:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://tools.ietf.org/html/rfc6749#section-1.3.2" target="_blank" rel="noopener">Implicit Grant</a>: Exposes tokens in the URL and lacks proper confidentiality guarantees.</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc6749#section-1.3.3" target="_blank" rel="noopener">Resource Owner Password Credentials Grant</a>: Involves direct transmission of user credentials and does not support modern identity federation.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_flow_recommendations"><a class="anchor" href="#_flow_recommendations"></a>6.4. Flow Recommendations</h3>
<div class="paragraph">
<p>The following recommendations apply based on client type and use case:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Public clients</strong> should use the <a href="https://tools.ietf.org/html/rfc6749#section-1.3.1" target="_blank" rel="noopener">Authorization Code Grant</a> with <a href="https://tools.ietf.org/html/rfc7636" target="_blank" rel="noopener">Proof Key for Code Exchange (PKCE)</a> exclusively. This flow offers strong security without requiring client secrets.</p>
</li>
<li>
<p><strong>Confidential clients</strong> may use the <a href="https://tools.ietf.org/html/rfc6749#section-1.3.1" target="_blank" rel="noopener">Authorization Code Grant</a> with <a href="https://tools.ietf.org/html/rfc7636" target="_blank" rel="noopener">Proof Key for Code Exchange (PKCE)</a>, or the <a href="https://tools.ietf.org/html/rfc6749#section-1.3.1" target="_blank" rel="noopener">Authorization Code Grant</a> with <code>client_secret</code>, depending on security infrastructure.</p>
</li>
<li>
<p><strong>Backend services</strong> must use a confidential client and are recommended to use the <a href="https://tools.ietf.org/html/rfc7523" target="_blank" rel="noopener">JWT Bearer Token Grant</a> (preferred) or the <a href="https://tools.ietf.org/html/rfc6749#section-1.3.4" target="_blank" rel="noopener">Client Credentials Grant</a>, depending on the level of trust and identity requirements.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These flows ensure secure and appropriate access to the <em>Platform</em> based on the capabilities and deployment context of the application.</p>
</div>
<div class="paragraph">
<p>The table below illustrates recommended flows for common application scenarios:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 35.7142%;">
<col style="width: 14.2857%;">
<col style="width: 21.4285%;">
<col style="width: 28.5716%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Application Example</th>
<th class="tableblock halign-left valign-top">Client Type</th>
<th class="tableblock halign-left valign-top">User Interaction Type</th>
<th class="tableblock halign-left valign-top">Recommended Flow</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Single Page Web Application for a Patient Portal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Public</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Patient-facing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authorization Code Grant with PKCE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mobile Application for Tracking Heart Rate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Public</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Patient-facing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authorization Code Grant with PKCE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Application with Backend for Cardiology Management</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidential</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Practitioner-facing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authorization Code Grant with PKCE or Authorization Code Grant with <code>client_secret</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Realtime Alert System for Hospital</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidential</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Backend service</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JWT Bearer Token Grant with JWS or Client Credentials Grant</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_authorization"><a class="anchor" href="#_authorization"></a>7. Authorization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Both <strong>patient-facing</strong> and <strong>practitioner-facing</strong> applications have specific authorization requirements that extend beyond the capabilities of the core <a href="https://tools.ietf.org/html/rfc6749" target="_blank" rel="noopener">OAuth 2.0 Authorization Framework</a>.
Depending on how an application is invoked, SMART Framework <a href="https://hl7.org/fhir/smart-app-launch/STU2.1/app-launch.html#smart-authorization--fhir-access-overview" target="_blank" rel="noopener">defines two launch</a>  contexts, enabling apps to obtain contextual access to clinical data based on the user and their session:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Standalone Launch</strong>: The <em>Application</em> is initiated directly by the end-user, outside the context of a running session on the <em>Platform</em>. For example, the user may visit <code>https://myapp.example.com</code> and select the Platform instance they want to connect to. The <em>Application</em> then begins the SMART authorization sequence using the selected Platform’s base URL and <code>.well-known/smart-configuration</code> metadata.</p>
</li>
<li>
<p><strong>EHR Launch</strong>: The <em>Application</em> is launched from within the Platform’s user interface (typically within an <code>iframe</code> within a Portal). The <em>Platform</em> passes the <code>iss</code> (issuer) and <code>launch</code> parameters to the Application, such as in <code>https://myapp.example.com?launch=123&amp;iss=https://platform.example.com</code>. The <code>iss</code> identifies the Platform (FHIR server), and the <code>launch</code> parameter conveys session-specific information used to retrieve additional context data.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>To avoid confusion with the <a href="https://specifications.openehr.org/releases/RM/latest/ehr.html#_ehr_package" target="_blank" rel="noopener">openEHR Reference Model&#8217;s <code>EHR</code></a> class, the <strong>EHR Launch</strong> is in this document referred to as an <strong>Embedded iFrame Launch</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_smart_authorization_flow"><a class="anchor" href="#_smart_authorization_flow"></a>7.1. SMART Authorization Flow</h3>
<div class="paragraph">
<p>The SMART framework builds on the <a href="https://tools.ietf.org/html/rfc6749#section-4.1" target="_blank" rel="noopener">OAuth 2.0 Authorization Code Flow</a> and defines several SMART-specific launch enhancements on how to <a href="https://hl7.org/fhir/smart-app-launch/STU2.1/app-launch.html#obtain-authorization-code" target="_blank" rel="noopener">obtain the authorization code</a>:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The <em>Application</em> redirects the user to the Platform&#8217;s <code>authorization_endpoint</code>, including SMART-specific query parameters such as <code>aud</code>, <code>launch</code>, <code>scope</code>, <code>state</code>, <code>redirect_uri</code>, etc.</p>
</li>
<li>
<p>The <em>Authorization Server</em> authenticates the user, validates the requested scopes, and (if allowed) issues an authorization <code>code</code> to the Application via the <code>redirect_uri</code>.</p>
</li>
<li>
<p>The <em>Application</em> exchanges the authorization <code>code</code> for an <code>access_token</code> and optionally an <code>id_token</code> and <code>refresh_token</code> by POSTing to the Platform’s <code>token_endpoint</code>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_context_selection"><a class="anchor" href="#_context_selection"></a>7.2. Context Selection</h3>
<div class="paragraph">
<p>In a <strong>Standalone Launch</strong>, a client <em>Application</em> can request the <em>Platform</em> to assist with <em>context</em> selection, provided that the relevant <a href="#_capabilities">capabilities</a> are supported by the <em>Platform</em>.
Most <strong>patient-facing</strong> and <strong>practitioner-facing</strong> applications will require the <em>Platform</em> to supply additional context during the authorization process.
This contextual data may include identifiers such as the openEHR EHR ID, FHIR Patient ID, Episode ID, etc. The context is typically valid for the duration of the user session.</p>
</div>
<div id="smart_standalone_launch" class="imageblock text-center text-center">
<div class="content">
<img src="smart_app_launch/diagrams/smart_standalone_launch.svg" alt="smart standalone launch">
</div>
<div class="title">Figure 2. Standalone Launch</div>
</div>
<div class="paragraph">
<p>The purpose of this <em>context</em> data is to pre-load or configure the <em>Application</em> to operate within a relevant clinical scope.
The <em>Platform</em> may determine this context automatically based on the authenticated user, or may prompt the user (e.g., via a selection screen) after the consent page if multiple valid contexts are possible.</p>
</div>
<div class="paragraph">
<p>To explicitly request openEHR-related launch context, the <em>Application</em> must include the following SMART-defined <strong>scopes</strong> in the authorization request:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Scope</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>launch/patient</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates that the Application requires patient context at launch (both FHIR <code>Patient</code> resource and corresponding openEHR <code>EHR</code> instance). For Standalone Launch, the user should be prompted to select the openEHR <code>EHR</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>launch/episode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates that the Application requires episode context at launch. (<a href="#_experimental_episode_context">Experimental</a>)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <em>Platform</em> returns the resolved context information in the token response, alongside the <code>access_token</code> and optionally an <code>id_token</code>. In addition to the standard <a href="https://hl7.org/fhir/smart-app-launch/STU2.1/scopes-and-launch-context.html#launch-context-arrives-with-your-access_token" target="_blank" rel="noopener">SMART App Launch context attributes</a>, the following openEHR-specific parameters may be included in the token response:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ehrId</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The unique identifier of the openEHR <code>EHR</code> instance associated with the selected FHIR <code>Patient</code> resource.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>episodeId</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The identifier of the selected clinical episode (if applicable). (<a href="#_experimental_episode_context">experimental</a>)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The Application may use these parameters to tailor the user interface and functionality to the selected clinical context.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>While this specification defines openEHR-specific launch parameters, standard SMART launch scopes and context attributes remain compatible and may be used in parallel for interoperability purposes. These are referenced from the <a href="https://hl7.org/fhir/smart-app-launch/STU2.1/scopes-and-launch-context.html" target="_blank" rel="noopener">SMART App Launch Framework</a>, but their use is not normative in this specification.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_embedded_iframe_launch"><a class="anchor" href="#_embedded_iframe_launch"></a>7.3. Embedded iFrame Launch</h3>
<div class="paragraph">
<p>Many <strong>practitioner-facing</strong> applications and, in some cases, <strong>patient-facing</strong> applications are integrated directly within a web-based front-end (e.g., a clinical portal or patient portal) using a dedicated component.</p>
</div>
<div class="paragraph">
<p>In an <strong>Embedded iFrame Launch</strong>, the <em>Platform</em> initiates the application by embedding it in an <code>iFrame</code> and passing key parameters directly in the URL:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>launch</code>: An opaque identifier or <a href="#_launch_parameter_as_a_token">token</a> that encodes relevant launch context (e.g., patient, EHR ID, episode).</p>
</li>
<li>
<p><code>iss</code>: The issuer URL representing the <em>Platform&#8217;s</em> base endpoint (which, for compatibility with SMART on FHIR, should also serve as the FHIR base URL).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, an application might be launched by: <code>https://myapp.example.com?launch=123&amp;iss=https://platform.example.com</code>.</p>
</div>
<div id="smart_embedded_iframe_launch" class="imageblock text-center text-center">
<div class="content">
<img src="smart_app_launch/diagrams/smart_embedded_iframe_launch.svg" alt="smart embedded iframe launch">
</div>
<div class="title">Figure 3. Embedded iFrame Launch</div>
</div>
<div class="paragraph">
<p>Once launched, the <em>Application</em> uses the <code>iss</code> value to retrieve the SMART configuration document from <code>{iss}/.well-known/smart-configuration</code>.</p>
</div>
<div class="paragraph">
<p>This configuration document provides important endpoints including the <code>authorization_endpoint</code>.
The <em>Application</em> uses this information to initiate the <a href="https://tools.ietf.org/html/rfc6749#section-1.3.1" target="_blank" rel="noopener">OAuth 2.0 Authorization Code Flow</a>, including the <code>launch</code> parameter in the authorization request.</p>
</div>
<div class="paragraph">
<p>To support this interaction model, the following SMART-defined <strong>scope</strong> must be also included in the authorization request:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Scope</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>launch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Permission to obtain launch context when Application is launched from an EHR (i.e., Embedded iFrame Launch).
            Must be accompanied by the <code>launch</code> parameter in the authorization request.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_scopes"><a class="anchor" href="#_scopes"></a>8. Scopes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Authorization is governed by <strong>scopes</strong>, which define the type and extent of access that a client <em>Application</em> is requesting from the <em>Platform</em>.</p>
</div>
<div class="paragraph">
<p>As specified in <a href="https://tools.ietf.org/html/rfc6749#section-3.3" target="_blank" rel="noopener">OAuth 2.0 Section 3.3</a>, scopes are passed during the authorization request and are evaluated by the <em>Platform</em> when issuing access tokens.
The <em>Platform</em> must validate requested scopes against the <em>Application</em> registration metadata, applicable access control policies, the authenticated user&#8217;s permissions.</p>
</div>
<div class="paragraph">
<p><strong>SMART on openEHR</strong> aligns with FHIR&#8217;s <a href="https://hl7.org/fhir/smart-app-launch/STU2.1/scopes-and-launch-context.html" target="_blank" rel="noopener">SMART App Launch Framework</a>, where scopes serve three main purposes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Resource Access</strong>: Grant access to specific resource types (e.g., <code>patient/composition-\*.rs</code>).</p>
</li>
<li>
<p><strong>Context Declaration</strong>: Request specific launch contexts (e.g., <code>launch/patient</code>).</p>
</li>
<li>
<p><strong>Identity Claims</strong>: Enable OpenID Connect scopes (e.g., <code>openid</code>) to identify the user.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_resource_scopes"><a class="anchor" href="#_resource_scopes"></a>8.1. Resource Scopes</h3>
<div class="paragraph">
<p>The <em>Application</em> can request access to the <em>Platform</em> resources using the scope syntax <code>&lt;compartment&gt;/&lt;resource&gt;.&lt;permission&gt;</code> where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>&lt;compartment&gt;</code> indicates the scope of access delegation:</p>
<div class="ulist">
<ul>
<li>
<p><code>patient</code>: Access is limited to the current EHR and Patient is present in the context.</p>
</li>
<li>
<p><code>user</code>: Access is granted based on the authenticated user&#8217;s permissions.</p>
</li>
<li>
<p><code>system</code>: Access is granted to backend applications acting without a user context.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>&lt;resource&gt;</code> identifies the openEHR or derived asset being accessed.</p>
</li>
<li>
<p><code>&lt;permissions&gt;</code> specifies the allowed operations.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following <code>&lt;compartment&gt;</code> are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>patient</code>: For applications acting in the context of a specific patient/EHR. Access is restricted to data within that patient&#8217;s EHR.</p>
</li>
<li>
<p><code>user</code>: For applications acting on behalf of a logged-in user (e.g., a practitioner). Access is subject to the user&#8217;s security profile, not limited to the Patient in context (if any is present).</p>
</li>
<li>
<p><code>system</code>: For server-to-server integrations or backend services, typically using client credentials, based on pre-configured client-specific policy. Grants access across all data.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following <a href="https://specifications.openehr.org/releases/ITS-REST/development">openEHR REST APIs</a> <code>&lt;resource&gt;</code> types are supported for use in scopes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>template-&lt;templateId&gt;</code> - Access to operational templates matching <code>&lt;templateId&gt;</code> expression.</p>
</li>
<li>
<p><code>composition-&lt;templateId&gt;</code> - Access to compositions of a given template matching <code>&lt;templateId&gt;</code> expression.</p>
</li>
<li>
<p><code>aql-&lt;queryName&gt;</code> - Access to pre-defined (matching <code>&lt;queryName&gt;</code> expression) or ad-hoc (using wildcard <code>*</code>) AQL queries.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>&lt;templateId&gt;</code> and <code>&lt;queryName&gt;</code> support wildcard and pattern-based matching using <code>*</code> and <code>**</code>, as follows:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Pattern</th>
<th class="tableblock halign-left valign-top">Matches</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MyHospital::Template.v0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Template exact match only</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.openehr::bloodpressure.v1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Query exact match only</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*::Template.v0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Template.v0 from any namespace</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MyHospital::*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any template within MyHospital namespace</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All available templates or queries</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following permission expressions are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>c</code> - Create</p>
</li>
<li>
<p><code>r</code> - Read</p>
</li>
<li>
<p><code>u</code> - Update</p>
</li>
<li>
<p><code>d</code> - Delete</p>
</li>
<li>
<p><code>s</code> - Search or execute (e.g., for AQL queries)</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Wildcard-based scopes (e.g., <code>*</code> or <code>**</code>) should be used cautiously and only when absolutely necessary, as they imply broad access. For example, <code>system/aql-*.rs</code> would grant access to all registered and ad-hoc AQL queries system-wide.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following table is a maximal representation of the scopes made possible in different <em>compartment</em>, <em>resource</em> and <em>permission</em> combinations:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Scope</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>patient/composition-&lt;templateId&gt;.crud</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Full CRUD access to compositions matching <code>&lt;templateId&gt;</code> in the current patient&#8217;s EHR.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>user/composition-&lt;templateId&gt;.crud</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Full CRUD access to compositions accessible by the user.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>system/composition-&lt;templateId&gt;.crud</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unrestricted CRUD access to compositions across the entire system.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>user/template-&lt;templateId&gt;.crud</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create and manage templates accessible to the user.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>system/template-&lt;templateId&gt;.crud</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Full system-wide template management.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>patient/aql-&lt;queryName&gt;.rs</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Execute and read AQL queries on the patient&#8217;s EHR data.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>user/aql-&lt;queryName&gt;.cruds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Full access to user-permitted AQL definitions or ad-hoc queries.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>system/aql-&lt;queryName&gt;.cruds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">System-wide access to AQL queries and endpoints.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_experimental_features"><a class="anchor" href="#_experimental_features"></a>9. Experimental features</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following concepts and aspects are considered experimental.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Implementers should treat its use as provisional and subject to change in future versions of this specification.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_launch_parameter_as_a_token"><a class="anchor" href="#_launch_parameter_as_a_token"></a>9.1. Launch Parameter as a Token</h3>
<div class="paragraph">
<p>To support efficient and context-rich embedded launches, it is <strong>recommended</strong> that the <code>launch</code> parameter be a <strong>base64-encoded JSON object</strong> containing launch context attributes such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ehrId</code> - The openEHR EHR identifier</p>
</li>
<li>
<p><code>patient</code> - FHIR Patient ID (if available)</p>
</li>
<li>
<p><code>episodeId</code> - Clinical episode ID (optional)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This allows the <em>Application</em> to initialize its interface with full context and potentially bypass a full authorization cycle if it is already authenticated.
This significantly improves the user experience, for instance, when switching patients within the same embedded session.</p>
</div>
<div class="paragraph">
<p>Platforms that support this optimization should advertise the following capabilities in their <code>/.well-known/smart-configuration</code> response:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>launch-base64-json</code>: May be used to deliver context (including <code>episodeId</code>) in a base64-encoded JSON format for embedded iFrame launches.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_experimental_episode_context"><a class="anchor" href="#_experimental_episode_context"></a>9.2. Experimental: Episode Context</h3>
<div class="paragraph">
<p>The <strong>Episode</strong> concept represents a bounded period of care or clinical workflow, such as a hospital admission, treatment course, or referral. It serves as a logical container for grouping related clinical activities, encounters, and observations. This concept is particularly relevant for workflows where context must be maintained across multiple interactions or systems.</p>
</div>
<div class="paragraph">
<p>In the context of SMART on openEHR, Episode selection and usage is considered <strong>experimental</strong>.
While the openEHR specification outlines the concept of an Episode, formal resource definitions and operational semantics are still evolving.
As the openEHR specification evolves to formalize Episode as a first-class resource, the following enhancements may be introduced:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Standardized resource representation of an Episode type or new archetype.</p>
</li>
<li>
<p>Extended query support for filtering by Episode.</p>
</li>
<li>
<p>Improved UI/UX support in authorization servers for Episode selection.</p>
</li>
<li>
<p>FHIR mapping for Episode-related concepts.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This section outlines the current capabilities and usage patterns under evaluation for Episode support.</p>
</div>
<div class="sect3">
<h4 id="_scopes_and_capabilities"><a class="anchor" href="#_scopes_and_capabilities"></a>9.2.1. Scopes and Capabilities</h4>
<div class="paragraph">
<p>To request Episode context during an authorization flow, the following scope may be included in the authorization request:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Scope</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>launch/episode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Requests Episode context at launch time. If launching outside an EHR, prompts the <em>Platform</em> to determine or allow selection of the Episode relevant to the session.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Platforms that support Episode context should advertise the following capabilities in their <code>/.well-known/smart-configuration</code> response:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>context-openehr-episode</code>: Indicates that the <em>Platform</em> supports Episode context selection during launch, requested via <code>launch/episode</code> scope.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_token_response_parameters"><a class="anchor" href="#_token_response_parameters"></a>9.2.2. Token Response Parameters</h4>
<div class="paragraph">
<p>When an authorization request includes <code>launch/episode</code> scope and the Platform is capable of resolving the Episode, the following parameter will be included in the token response:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">episodeId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifier of the selected or inferred Episode for the session. This may map to an openEHR EHR_STATUS.episode or a platform-specific abstraction. Its semantics are currently implementation-defined.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This value is intended to be used by the client Application to filter or group clinical data relevant to the specific Episode of care.</p>
</div>
</div>
<div class="sect3">
<h4 id="_launch_scenarios"><a class="anchor" href="#_launch_scenarios"></a>9.2.3. Launch Scenarios</h4>
<div class="paragraph">
<p>Standalone Launch:
When the <code>launch/episode</code> scope is included, the Platform may prompt the user to select an Episode or infer it automatically based on session context (e.g., currently admitted case, recent discharge summary, etc.).</p>
</div>
<div class="paragraph">
<p>Embedded iFrame Launch:
Episode context may be embedded in a base64-encoded <code>launch</code> parameter provided at runtime. This can improve usability by avoiding a separate Episode selection prompt during intra-portal navigation.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_references"><a class="anchor" href="#_references"></a>References</h2>
<div class="sectionbody">
<div class="ulist bibliography">
<ul class="bibliography">
<li>
<p>SMART App Launch - Release 2.1.0 (2021), <a href="https://hl7.org/fhir/smart-app-launch/STU2.1" class="bare">https://hl7.org/fhir/smart-app-launch/STU2.1</a></p>
</li>
<li>
<p>The 'About SMART' page on SMART Health IT, <a href="https://smarthealthit.org/about-smart-2/" class="bare">https://smarthealthit.org/about-smart-2/</a></p>
</li>
<li>
<p>OAuth 2.0 Authorization Framework, <a href="https://tools.ietf.org/html/rfc6749" class="bare">https://tools.ietf.org/html/rfc6749</a></p>
</li>
<li>
<p>OAuth 2.0 Dynamic Client Registration Protocol, <a href="https://tools.ietf.org/html/rfc7591" class="bare">https://tools.ietf.org/html/rfc7591</a></p>
</li>
<li>
<p>OpenId Connect (OIDC), <a href="https://openid.net/specs/openid-connect-core-1_0.html#Authentication" class="bare">https://openid.net/specs/openid-connect-core-1_0.html#Authentication</a></p>
</li>
<li>
<p>JSON Web Token (JWT) Assertion, <a href="https://tools.ietf.org/html/rfc7523" class="bare">https://tools.ietf.org/html/rfc7523</a></p>
</li>
<li>
<p>JSON Web Signature (JWS), <a href="https://tools.ietf.org/html/rfc7515" class="bare">https://tools.ietf.org/html/rfc7515</a></p>
</li>
<li>
<p>Best Practices in Authorization for SMART on FHIR EHRs, <a href="https://docs.smarthealthit.org/authorization/best-practices" class="bare">https://docs.smarthealthit.org/authorization/best-practices</a></p>
</li>
</ul>
</div>
<div id="smart_logo" class="imageblock text-center">
<div class="content">
<a class="image" href="https://smarthealthit.org/"><img src="smart_app_launch/diagrams/smart_logo.svg" alt="SMART" width="140" height="80"></a>
</div>
<div class="title">SMART™ and the SMART logos are trademarks of The Children&#8217;s Medical Center Corporation. Used with permission.</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-06-18 07:28:52 UTC
</div>
</div>
<script src="https://specifications.openehr.org/js/asciidoctor-tabs.js"></script>
</body>
</html>